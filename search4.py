#coding:utf-8
import os
import glob
from astropy.io import fits
import csv
import numpy as np
from tqdm import tqdm

csvpath = "/home/tajiri/tess/pipeline/incorrect.csv"
datadir = "/pike/tess/data/FFI"
#fitslist = glob.glob(os.path.join(datadir, "*s0004*.fits"))
fitslist = ['/pike/tess/data/FFI/tess2018275082940-s0003-2-1-0123-s_ffir.fits','/pike/tess/data/FFI/tess2018283025940-s0003-1-4-0123-s_ffir.fits','/pike/tess/data/FFI/tess2018271145940-s0003-1-2-0123-s_ffic.fits','/pike/tess/data/FFI/tess2018282192940-s0003-1-1-0123-s_ffir.fits','/pike/tess/data/FFI/tess2018277135940-s0003-3-3-0123-s_ffir.fits','/pike/tess/data/FFI/tess2018289012940-s0003-3-3-0123-s_ffic.fits','/pike/tess/data/FFI/tess2018279102940-s0003-3-3-0123-s_ffir.fits','/pike/tess/data/FFI/tess2018279042940-s0003-4-3-0123-s_ffic.fits','/pike/tess/data/FFI/tess2018263152941-s0003-1-1-0123-s_ffic.fits','/pike/tess/data/FFI/tess2018280162940-s0003-2-2-0123-s_ffir.fits','/pike/tess/data/FFI/tess2018273232940-s0003-2-3-0123-s_ffir.fits','/pike/tess/data/FFI/tess2018276095940-s0003-4-1-0123-s_ffic.fits','/pike/tess/data/FFI/tess2018277182940-s0003-2-1-0123-s_ffir.fits','/pike/tess/data/FFI/tess2018269105941-s0003-4-3-0123-s_ffir.fits','/pike/tess/data/FFI/tess2018272002940-s0003-3-4-0123-s_ffic.fits','/pike/tess/data/FFI/tess2018270025940-s0003-4-3-0123-s_ffic.fits','/pike/tess/data/FFI/tess2018265175941-s0003-2-4-0123-s_ffir.fits','/pike/tess/data/FFI/tess2018275142940-s0003-2-4-0123-s_ffic.fits','/pike/tess/data/FFI/tess2018269042941-s0003-2-3-0123-s_ffir.fits','/pike/tess/data/FFI/tess2018264155941-s0003-3-3-0123-s_ffir.fits','/pike/tess/data/FFI/tess2018289135940-s0003-3-2-0123-s_ffir.fits','/pike/tess/data/FFI/tess2018265085941-s0003-1-3-0123-s_ffir.fits','/pike/tess/data/FFI/tess2018290092940-s0003-1-1-0123-s_ffic.fits','/pike/tess/data/FFI/tess2018290125940-s0003-3-1-0123-s_ffir.fits','/pike/tess/data/FFI/tess2018283135940-s0003-2-2-0123-s_ffir.fits','/pike/tess/data/FFI/tess2018266205941-s0003-3-2-0123-s_ffic.fits','/pike/tess/data/FFI/tess2018264035941-s0003-3-1-0123-s_ffir.fits','/pike/tess/data/FFI/tess2018270175940-s0003-2-1-0123-s_ffir.fits','/pike/tess/data/FFI/tess2018268102941-s0003-4-1-0123-s_ffic.fits','/pike/tess/data/FFI/tess2018283095940-s0003-4-2-0123-s_ffir.fits','/pike/tess/data/FFI/tess2018278042940-s0003-3-1-0123-s_ffic.fits','/pike/tess/data/FFI/tess2018287235940-s0003-4-1-0123-s_ffir.fits','/pike/tess/data/FFI/tess2018284082940-s0003-4-3-0123-s_ffir.fits','/pike/tess/data/FFI/tess2018279005940-s0003-2-2-0123-s_ffir.fits','/pike/tess/data/FFI/tess2018268155941-s0003-3-4-0123-s_ffir.fits','/pike/tess/data/FFI/tess2018274115940-s0003-3-3-0123-s_ffir.fits','/pike/tess/data/FFI/tess2018266215941-s0003-2-1-0123-s_ffir.fits','/pike/tess/data/FFI/tess2018284092940-s0003-3-3-0123-s_ffic.fits','/pike/tess/data/FFI/tess2018270002940-s0003-1-3-0123-s_ffir.fits','/pike/tess/data/FFI/tess2018288182940-s0003-3-4-0123-s_ffic.fits','/pike/tess/data/FFI/tess2018266222941-s0003-3-2-0123-s_ffir.fits','/pike/tess/data/FFI/tess2018266092941-s0003-1-4-0123-s_ffir.fits','/pike/tess/data/FFI/tess2018285105940-s0003-3-2-0123-s_ffir.fits','/pike/tess/data/FFI/tess2018290105940-s0003-2-2-0123-s_ffir.fits','/pike/tess/data/FFI/tess2018280125940-s0003-3-3-0123-s_ffir.fits','/pike/tess/data/FFI/tess2018278072940-s0003-3-3-0123-s_ffir.fits','/pike/tess/data/FFI/tess2018276125940-s0003-3-3-0123-s_ffic.fits','/pike/tess/data/FFI/tess2018272022940-s0003-4-4-0123-s_ffir.fits','/pike/tess/data/FFI/tess2018283012940-s0003-4-2-0123-s_ffir.fits','/pike/tess/data/FFI/tess2018270105940-s0003-1-3-0123-s_ffic.fits','/pike/tess/data/FFI/tess2018288222940-s0003-3-4-0123-s_ffic.fits','/pike/tess/data/FFI/tess2018271075940-s0003-2-3-0123-s_ffir.fits','/pike/tess/data/FFI/tess2018282032940-s0003-3-2-0123-s_ffir.fits','/pike/tess/data/FFI/tess2018280015940-s0003-3-1-0123-s_ffir.fits','/pike/tess/data/FFI/tess2018283012940-s0003-3-1-0123-s_ffir.fits','/pike/tess/data/FFI/tess2018268045941-s0003-3-3-0123-s_ffic.fits','/pike/tess/data/FFI/tess2018283175940-s0003-4-2-0123-s_ffir.fits','/pike/tess/data/FFI/tess2018288175940-s0003-4-3-0123-s_ffic.fits','/pike/tess/data/FFI/tess2018270232940-s0003-4-3-0123-s_ffir.fits','/pike/tess/data/FFI/tess2018286095940-s0003-1-3-0123-s_ffir.fits','/pike/tess/data/FFI/tess2018266165941-s0003-3-3-0123-s_ffic.fits','/pike/tess/data/FFI/tess2018287105940-s0003-4-3-0123-s_ffir.fits','/pike/tess/data/FFI/tess2018272105940-s0003-1-1-0123-s_ffic.fits','/pike/tess/data/FFI/tess2018272185940-s0003-1-2-0123-s_ffir.fits','/pike/tess/data/FFI/tess2018280102940-s0003-3-3-0123-s_ffir.fits','/pike/tess/data/FFI/tess2018277132940-s0003-2-4-0123-s_ffir.fits','/pike/tess/data/FFI/tess2018273102940-s0003-3-3-0123-s_ffir.fits','/pike/tess/data/FFI/tess2018278112940-s0003-3-1-0123-s_ffic.fits','/pike/tess/data/FFI/tess2018264052941-s0003-3-2-0123-s_ffir.fits','/pike/tess/data/FFI/tess2018267012941-s0003-1-1-0123-s_ffir.fits','/pike/tess/data/FFI/tess2018266075941-s0003-3-2-0123-s_ffir.fits','/pike/tess/data/FFI/tess2018266165941-s0003-1-2-0123-s_ffir.fits','/pike/tess/data/FFI/tess2018280172940-s0003-4-1-0123-s_ffir.fits','/pike/tess/data/FFI/tess2018284152940-s0003-4-2-0123-s_ffic.fits','/pike/tess/data/FFI/tess2018290182940-s0003-2-2-0123-s_ffir.fits','/pike/tess/data/FFI/tess2018282035940-s0003-4-1-0123-s_ffir.fits','/pike/tess/data/FFI/tess2018267055941-s0003-3-3-0123-s_ffic.fits','/pike/tess/data/FFI/tess2018279215940-s0003-1-1-0123-s_ffir.fits','/pike/tess/data/FFI/tess2018294012940-s0004-2-3-0124-s_ffir.fits','/pike/tess/data/FFI/tess2018296082940-s0004-4-2-0124-s_ffir.fits','/pike/tess/data/FFI/tess2018316132940-s0004-3-4-0124-s_ffic.fits','/pike/tess/data/FFI/tess2018315182940-s0004-4-2-0124-s_ffir.fits','/pike/tess/data/FFI/tess2018314045940-s0004-4-4-0124-s_ffir.fits','/pike/tess/data/FFI/tess2018317232939-s0004-4-2-0124-s_ffir.fits','/pike/tess/data/FFI/tess2018314232940-s0004-1-2-0124-s_ffic.fits','/pike/tess/data/FFI/tess2018317222939-s0004-2-1-0124-s_ffic.fits','/pike/tess/data/FFI/tess2018293112940-s0004-3-2-0124-s_ffir.fits','/pike/tess/data/FFI/tess2018313072940-s0004-1-1-0124-s_ffir.fits','/pike/tess/data/FFI/tess2018298125940-s0004-4-4-0124-s_ffir.fits','/pike/tess/data/FFI/tess2018293222940-s0004-1-4-0124-s_ffic.fits','/pike/tess/data/FFI/tess2018312195940-s0004-4-4-0124-s_ffir.fits','/pike/tess/data/FFI/tess2018294112940-s0004-1-3-0124-s_ffir.fits','/pike/tess/data/FFI/tess2018306105940-s0004-2-4-0124-s_ffir.fits','/pike/tess/data/FFI/tess2018294135940-s0004-3-2-0124-s_ffir.fits','/pike/tess/data/FFI/tess2018296072940-s0004-1-1-0124-s_ffir.fits','/pike/tess/data/FFI/tess2018294172940-s0004-4-2-0124-s_ffic.fits','/pike/tess/data/FFI/tess2018316092940-s0004-1-3-0124-s_ffir.fits','/pike/tess/data/FFI/tess2018298002940-s0004-1-4-0124-s_ffir.fits','/pike/tess/data/FFI/tess2018316165940-s0004-2-3-0124-s_ffic.fits','/pike/tess/data/FFI/tess2018311032940-s0004-1-3-0124-s_ffir.fits','/pike/tess/data/FFI/tess2018313002940-s0004-4-2-0124-s_ffic.fits','/pike/tess/data/FFI/tess2018294212940-s0004-2-2-0124-s_ffir.fits','/pike/tess/data/FFI/tess2018307115940-s0004-2-4-0124-s_ffir.fits','/pike/tess/data/FFI/tess2018312045940-s0004-3-1-0124-s_ffir.fits','/pike/tess/data/FFI/tess2018317182939-s0004-1-4-0124-s_ffir.fits','/pike/tess/data/FFI/tess2018307102940-s0004-4-4-0124-s_ffic.fits','/pike/tess/data/FFI/tess2018312055940-s0004-3-2-0124-s_ffir.fits','/pike/tess/data/FFI/tess2018295155940-s0004-4-1-0124-s_ffir.fits','/pike/tess/data/FFI/tess2018297175940-s0004-2-3-0124-s_ffir.fits','/pike/tess/data/FFI/tess2018308205940-s0004-2-3-0124-s_ffir.fits','/pike/tess/data/FFI/tess2018303172940-s0004-4-2-0124-s_ffir.fits','/pike/tess/data/FFI/tess2018299155940-s0004-1-1-0124-s_ffir.fits','/pike/tess/data/FFI/tess2018293145940-s0004-3-1-0124-s_ffir.fits','/pike/tess/data/FFI/tess2018293052940-s0004-2-3-0124-s_ffir.fits','/pike/tess/data/FFI/tess2018313055940-s0004-2-3-0124-s_ffic.fits','/pike/tess/data/FFI/tess2018315092940-s0004-3-1-0124-s_ffir.fits','/pike/tess/data/FFI/tess2018316132940-s0004-4-4-0124-s_ffir.fits','/pike/tess/data/FFI/tess2018297185940-s0004-2-1-0124-s_ffir.fits','/pike/tess/data/FFI/tess2018317012939-s0004-3-2-0124-s_ffir.fits','/pike/tess/data/FFI/tess2018309155940-s0004-1-3-0124-s_ffir.fits','/pike/tess/data/FFI/tess2018309185940-s0004-1-1-0124-s_ffir.fits','/pike/tess/data/FFI/tess2018296205940-s0004-4-2-0124-s_ffir.fits','/pike/tess/data/FFI/tess2018295232940-s0004-4-1-0124-s_ffic.fits','/pike/tess/data/FFI/tess2018295122940-s0004-2-3-0124-s_ffir.fits','/pike/tess/data/FFI/tess2018317202939-s0004-4-2-0124-s_ffir.fits','/pike/tess/data/FFI/tess2018298082940-s0004-4-4-0124-s_ffir.fits','/pike/tess/data/FFI/tess2018293052940-s0004-3-4-0124-s_ffir.fits','/pike/tess/data/FFI/tess2018298075940-s0004-2-4-0124-s_ffic.fits','/pike/tess/data/FFI/tess2018295162940-s0004-2-2-0124-s_ffir.fits','/pike/tess/data/FFI/tess2018298042940-s0004-1-1-0124-s_ffir.fits','/pike/tess/data/FFI/tess2018309192940-s0004-3-3-0124-s_ffic.fits','/pike/tess/data/FFI/tess2018311045940-s0004-1-2-0124-s_ffir.fits','/pike/tess/data/FFI/tess2018306052940-s0004-3-1-0124-s_ffic.fits','/pike/tess/data/FFI/tess2018297155940-s0004-3-3-0124-s_ffic.fits']
with open(csvpath, "w") as f:
    writer = csv.writer(f, lineterminator="\n")
    for fitspath in tqdm(fitslist):
        try:
            hdu = fits.open(fitspath)
            data = np.array(hdu[1].data)
            hdu.close()
        except:
            writer.writerow([fitspath])
